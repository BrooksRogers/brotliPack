CC = gcc
CFLAGS = -Wall -Wextra -O2
BROTLI_ENCODER_LIB = -lbrotlienc
BROTLI_DECODER_LIB = -lbrotlidec

PACKER = packer
PACKER_SRC = packer.c

SELFEXTRACTOR = self_extractor_inmem
SELFEXTRACTOR_SRC = selfextractor_inmem.c

.PHONY: all clean

all: $(PACKER) $(SELFEXTRACTOR)

$(PACKER): $(PACKER_SRC)
	$(CC) $(CFLAGS) $(PACKER_SRC) -o $(PACKER) $(BROTLI_ENCODER_LIB)

$(SELFEXTRACTOR): $(SELFEXTRACTOR_SRC)
	$(CC) $(CFLAGS) $(SELFEXTRACTOR_SRC) -o $(SELFEXTRACTOR) $(BROTLI_DECODER_LIB) -ldl

clean:
	rm -f $(PACKER) $(SELFEXTRACTOR)
